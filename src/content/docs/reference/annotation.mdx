---
title: 注解配置
sidebar:
  order: 2
---

import { LinkCard } from '@astrojs/starlight/components';
import Badge from "@/components/Badge.astro";

本文详细介绍了 MyBatisPlus 注解的用法及属性，提供了源码链接以便深入理解。欢迎通过下方链接查看注解类的源码。

<LinkCard
  title="MyBatis-Plus Annotation 源码"
  description="源码中包含较为完整的注释，可以查看源码了解功能。"
  href="https://github.com/baomidou/mybatis-plus/tree/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation"
/>

## @TableName

用于标识实体类对应的数据库表名。
- 当您的实体类与数据库表名不一致时，请使用该注解指定表名。
- 当您的实体类与数据库表名一致，且实体类是数据库表名的驼峰写法时，该注解可省略。

```java {1}
@TableName("sys_user")
public class User {
    private Long id;
    private String name;
    private Integer age;
    private String email;
}
```

### value
<p>
    **类型：** `String` <br/>
    **默认值：** `""`
</p>

填写当前实体类所对应的数据库表名。

### schema
<p>
    **类型：** `String` <br/>
    **默认值：** `""`
</p>

填写数据库对应的 `Schema`，通常不用填写。

### keepGlobalPrefix
<p>
    **类型：** `boolean` <br/>
    **默认值：** `false`
</p>

在全局 `tablePrefix` 配置生效时是否保持使用全局的 `tablePrefix` 的值。

> 全局 `tablePrefix` 配置：TODO

### resultMap
<p>
    **类型：** `String` <br/>
    **默认值：** `""`
</p>

填写 `XML` 中 `ResultMap` 的 `id`，用于满足特定类型的实体类对象绑定。

### autoResultMap
<p>
    **类型：** `boolean` <br/>
    **默认值：** `false`
</p>

是否自动构建 `resultMap`。

:::note
如果已经设置 `resultMap`，配置该属性不生效，不会进行 `resultMap` 的自动构建与注入。
:::

MyBatis-Plus 会自动构建一个 resultMap 并注入到 MyBatis 中。请注意以下内容：

由于 MyBatis-Plus 底层是基于 MyBatis 的，因此 MyBatis-Plus 会根据您的实体类字段和注解变化动态地注入常用的 CRUD 操作到 MyBatis 中。但一旦注入完成，生成的内容就是静态的，等同于 XML 配置中的内容。

在使用与 resultMap 相关的操作时，请注意 typeHandler 的处理。MyBatis 只支持将 typeHandler 写在两个地方：

- 定义在 resultMap 中，作用于查询结果的封装。
- 定义在 insert 和 update 语句的 `#{property}` 中的 property 后面，例如：`#{property,typehandler=xxx.xxx.xxx}`，并且只作用于当前设置的值。

除了以上两种直接指定 typeHandler 的形式，MyBatis 还有一个全局扫描自定义 typeHandler 包的配置，原理是根据您的属性类型去找其对应的 typeHandler 并使用。

### excludeProperty
<p>
    **类型：** `String[]` <br/>
    **默认值：** `{}` <br/>
    **添加于：** <Badge text="@since 3.3.1" vertical="middle"/>
</p>

指定需要排除的属性名。

## @TableId

用于标识实体类的主键字段。如果您的主键 ID 名称为 id，则该注解可以省略。

```java {3}
@TableName("sys_user")
public class User {
    @TableId
    private Long id;
    private String name;
    private Integer age;
    private String email;
}
```

### value
<p>
    **类型：** `String` <br/>
    **默认值：** `""`
</p>

指定当前表主键字段名。如果不设置，将使用实体类的字段名作为数据库表的主键字段。

### type
<p>
    **类型：** `Enum` <br/>
    **默认值：** `IdType.NONE`
</p>

指定主键的生成策略。

#### IdType

`IdType` 详细的类型定义如下：

- `IdType.AUTO`：数据库 ID 自增。
- `IdType.NONE`：无状态，未设置主键类型，如果全局配置中有 IdType 相关的配置，则会跟随全局配置。
- `IdType.INPUT`：数据库插入操作前自行设置主键值。
- `IdType.ASSIGN_ID`：自动分配 `ID`，适用于 `Long`、`Integer`、`String` 类型的主键。默认使用雪花算法通过 `IdentifierGenerator` 的 `nextId` 实现。<Badge text="@since 3.3.0"/>
- `IdType.ASSIGN_UUID`：自动分配 `UUID`，适用于 `String` 类型的主键。默认实现为 `IdentifierGenerator` 的 `nextUUID` 方法。<Badge text="@since 3.3.0"/>、

:::note
请注意，已弃用的ID类型（如 `ID_WORKER`, `UUID`, `ID_WORKER_STR`）应避免使用，并使用 `ASSIGN_ID` 或 `ASSIGN_UUID` 代替。
:::

## @TableField

用于标识实体类的非主键字段。如果您的实体类字段名称是数据库字段的驼峰写法，则该注解可以忽略。

```java {5}
@TableName("sys_user")
public class User {
    @TableId
    private Long id;
    @TableField("nickname")
    private String name;
    private Integer age;
    private String email;
}
```

### value
<p>
    **类型：** `String`<br/>
    **默认值：** `""`
</p>
指定数据库字段名。

### exist
<p>
    **类型：** `boolean`<br/>
    **默认值：** `true`
</p>
指示是否为数据库表字段。

### condition
<p>
    **类型：** `String`<br/>
    **默认值：** `""`
</p>
在按照实体查询（EntityQuery）时，字段所运用比较条件的写法注入。

如有值则按设置的值为准，无值则默认为全局的 `%s=#{%s}`，写法详见 [SqlCondition](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/SqlCondition.java)。

### update
<p>
    **类型：** `String`<br/>
    **默认值：** `""`
</p>
字段在更新（Update）时，`set` 部分的写法注入，该属性优先级高于 `el` 属性。

例如，当在 `version` 字段上注解 `update="%s+1"` 表示更新时会 `set version=version+1`。

### insertStrategy
<p>
    **类型：** `Enum`<br/>
    **默认值：** `FieldStrategy.DEFAULT`
</p>

字段在新增时的策略。

`FieldStrategy.DEFAULT`：该属性表示默认参考全局配置，而全部配置默认又是 `FieldStrategy.NOT_NULL`，所以使用该项配置等同于如下 XML SQL

    ```xml
    insert into table_a(<if test="columnProperty != null">column</if>) 
    values (<if test="columnProperty != null">#{columnProperty}</if>)
    ```

### updateStrategy
<p>
    **类型：** `Enum`<br/>
    **默认值：** `FieldStrategy.DEFAULT`
</p>
举例：`IGNORED`  
`update table_a set column=#{columnProperty}`。

### whereStrategy
<p>
    **类型：** `Enum`<br/>
    **默认值：** `FieldStrategy.DEFAULT`
</p>
举例：`NOT_EMPTY`  
`where <if test="columnProperty != null and columnProperty!=''">column=#{columnProperty}</if>`。

### fill
<p>
    **类型：** `Enum`<br/>
    **默认值：** `FieldFill.DEFAULT`
</p>
字段自动填充策略。

### select
<p>
    **类型：** `boolean`<br/>
    **默认值：** `true`
</p>
指示是否进行 select 查询。

### keepGlobalFormat
<p>
    **类型：** `boolean`<br/>
    **默认值：** `false`
</p>
指示是否保持使用全局的 format 进行处理。

### jdbcType
<p>
    **类型：** `JdbcType`<br/>
    **默认值：** `JdbcType.UNDEFINED`
</p>
JDBC类型（该默认值不代表会按照该值生效）。

### typeHandler
<p>
    **类型：** `Class<? extends TypeHandler>`<br/>
    **默认值：** `UnknownTypeHandler.class`
</p>
类型处理器（该默认值不代表会按照该值生效）。

### numericScale
<p>
    **类型：** `String`<br/>
    **默认值：** `""`
</p>
指定小数点后保留的位数，只生效于 update 的 SQL。

::: warning 关于`jdbcType`和`typeHandler`以及`numericScale`的说明:
`numericScale`只生效于 update 的 SQL。
`jdbcType`和`typeHandler`如果不配合`@TableName#autoResultMap = true`一起使用,也只生效于 update 的 SQL。
对于`typeHandler`，如果你的字段类型和 set 进去的类型为`equals`关系，则只需要让你的`typeHandler`让 Mybatis 加载到即可，不需要使用注解。
:::

### [FieldStrategy](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/FieldStrategy.java)

| 值                | 描述                                                        |
| :---------------- | :---------------------------------------------------------- |
| IGNORED（已弃用） | 忽略判断，效果等同于"ALWAYS"                                |
| ALWAYS            | 总是加入 SQL，无论字段值是否为 NULL                         |
| NOT_NULL          | 非 NULL 判断                                                |
| NOT_EMPTY         | 非空判断(只对字符串类型字段,其他类型字段依然为非 NULL 判断) |
| DEFAULT           | 追随全局配置                                                |
| NEVER             | 不加入 SQL                                                  |

### [FieldFill](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/FieldFill.java)

| 值            | 描述                 |
| :------------ | :------------------- |
| DEFAULT       | 默认不处理           |
| INSERT        | 插入时填充字段       |
| UPDATE        | 更新时填充字段       |
| INSERT_UPDATE | 插入和更新时填充字段 |

## [@Version](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/Version.java)

- 描述：乐观锁注解、标记 `@Version` 在字段上

## [@EnumValue](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/EnumValue.java)

- 描述：普通枚举类注解(注解在枚举字段上)

## [@TableLogic](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/TableLogic.java)

- 描述：表字段逻辑处理注解（逻辑删除）

| 属性   | 类型   | 必须指定 | 默认值 | 描述         |
| :----- | :----- | :------- | :----- | :----------- |
| value  | String | 否       | ""     | 逻辑未删除值 |
| delval | String | 否       | ""     | 逻辑删除值   |

## [@SqlParser](https://gitee.com/baomidou/mybatis-plus/blob/v3.4.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/SqlParser.java) <Badge text="Deprecated" type="warn"/>

> see [@InterceptorIgnore](#InterceptorIgnore)

## [@KeySequence](https://github.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/KeySequence.java)

- 描述：序列主键策略 `oracle`
- 属性：value、dbType

| 属性   | 类型   | 必须指定 | 默认值       | 描述                                                                |
| :----- | :----- | :------- | :----------- | :------------------------------------------------------------------ |
| value  | String | 否       | ""           | 序列名                                                              |
| dbType | Enum   | 否       | DbType.OTHER | 数据库类型，未配置默认使用注入 IKeyGenerator 实现，多个实现必须指定 |

## [@InterceptorIgnore](https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/InterceptorIgnore.java)

- `value` 值为 `1` | `yes` | `on` 视为忽略，例如 `@InterceptorIgnore(tenantLine = "1")`

- `value` 值为 `0` | `false` | `off` | `空值不变` 视为正常执行。

> see [插件主体](/pages/2976a3/)

## [@OrderBy](https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-annotation/src/main/java/com/baomidou/mybatisplus/annotation/OrderBy.java)

- 描述：内置 SQL 默认指定排序，优先级低于 wrapper 条件查询

| 属性 | 类型    | 必须指定 | 默认值          | 描述           |
| :--- | :------ | :------- | :-------------- | :------------- |
| asc  | boolean | 否       | true            | 是否倒序查询   |
| sort | short   | 否       | Short.MAX_VALUE | 数字越小越靠前 |
